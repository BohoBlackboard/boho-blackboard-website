<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Thank You | Boho Blackboard</title>
  <link rel="stylesheet" href="style.css">
  <link rel="icon" type="image/png" href="bb favicon.png">
</head>

<body>

<header>
  <h1 class="logo">Boho Blackboard</h1>
  <div class="swoosh"></div>
</header>

<section class="sub-banner">
  <img src="banner.png" alt="">
</section>

<main class="content" style="text-align:center;">
  <h2>Thank You for Your Purchase!</h2>
  <p>Your download links are being emailed to you now. ðŸ’›</p>
  <p>If you do not receive an email within 2 minutes, please check your spam folder.</p>

  <h3 id="status-message" style="margin-top:20px; font-size:1.1rem;"></h3>
</main>

<footer>
  Â© 2025 Boho Blackboard | Designed from the heart by Danielle Droste
</footer>

<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>

<script>
// -----------------------------------------------------------
// EmailJS init
// -----------------------------------------------------------
emailjs.init("_RstzO3AfSZ0UV3y7");

// -----------------------------------------------------------
// Load data saved before checkout
// -----------------------------------------------------------
const cart = JSON.parse(localStorage.getItem("cart") || "[]");
const email = localStorage.getItem("customer_email") || "";

const statusBox = document.getElementById("status-message");

if (!cart.length || !email) {
  statusBox.textContent = "âš  Missing purchase data. Please contact support.";
} else {
  sendDownloadEmail();
}

// -----------------------------------------------------------
// ZIP links by theme + language
// -----------------------------------------------------------
const fileLinks = {
  "DSH_EN": "https://bohoblackboard.github.io/boho/downloads/boho-dachshunds.zip",
  "DSH_AF": "https://bohoblackboard.github.io/boho/downloads/boho-dachshunds-afrikaans.zip",
  "OWL_EN": "https://bohoblackboard.github.io/boho/downloads/boho-owls.zip",
  "OWL_AF": "https://bohoblackboard.github.io/boho/downloads/boho-owls-afrikaans.zip"
};

// friendly names
const friendlyNames = {
  "DSH_EN": "Boho Dachshunds â€“ English",
  "DSH_AF": "Boho Worshonde â€“ Afrikaans",
  "OWL_EN": "Boho Owls â€“ English",
  "OWL_AF": "Boho Uile â€“ Afrikaans"
};

// -----------------------------------------------------------
// Build email text body
// -----------------------------------------------------------
function buildList() {
  let text = "";

  cart.forEach(item => {
    const link = fileLinks[item.code];
    const name = friendlyNames[item.code];

    if (link && name) {
      text += `${name}:\n${link}\n\n`;
    }
  });

  return text;
}

// -----------------------------------------------------------
function sendDownloadEmail() {
  const productList = buildList();

  const params = {
    customer_email: email,
    product_list: productList,
    name: "Boho Blackboard"
  };

  emailjs.send("service_96euu0a", "template_2ib1ulk", params)
    .then(() => {
      statusBox.textContent = "ðŸ“¨ Your download links have been sent!";
      localStorage.removeItem("cart");
      localStorage.removeItem("customer_email");
    })
    .catch(() => {
      statusBox.textContent = "âš  Email could not be sent. Please contact support.";
    });
}
</script>

</body>
</html>
